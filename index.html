<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Love Hurts ‚Äî Saturday 2/13/26</title>
    <style>
        html, body {
            height: 100%; margin: 0; background: linear-gradient(135deg, #0a0a1a 0%, #2a0a1a 50%, #1a0a1a 100%); 
            color: #fff; font-family: 'Arial', sans-serif; overflow: hidden;
        }
        .wrap {
            display: flex; flex-direction: column; align-items: center;
            padding: 12px; height: 100vh; position: relative; z-index: 1;
        }
        h1 { margin: 8px 0; font-size: 20px; }
        .ui {
            width: 800px; display: flex; justify-content: space-around;
            align-items: center; margin: 8px 0; gap: 12px;
        }
        .panel {
            background: rgba(255, 45, 149, 0.2); padding: 6px 12px;
            border-radius: 6px; border: 1px solid #ff2d95; font-size: 12px;
        }
        canvas {
            background: radial-gradient(ellipse at center, #1a1a2e 0%, #0a0a0a 100%);
            box-shadow: 0 0 40px rgba(255, 45, 149, 0.4), inset 0 0 20px rgba(0, 0, 0, 0.8);
            border: 2px solid #ff2d95; border-radius: 4px;
        }
        .controls {
            width: 800px; text-align: center; font-size: 11px; margin-top: 8px;
            color: #aaa;
        }
        
        /* Cutscene system */
        #cutsceneContainer {
            position: fixed; inset: 0; background: rgba(0, 0, 0, 0.95);
            display: none; z-index: 100; flex-direction: column;
            align-items: center; justify-content: center;
            animation: fadeIn 0.4s ease-out;
        }
        #cutsceneContainer.active { display: flex; }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .cutscene-slide {
            width: 90%; max-width: 900px; height: 80vh;
            background: linear-gradient(135deg, #1a0a1a, #0a1a2e);
            border: 2px solid #ff2d95; border-radius: 8px;
            display: flex; align-items: center; justify-content: space-between;
            padding: 40px; gap: 40px; box-shadow: 0 0 50px rgba(255, 45, 149, 0.5);
            position: relative; overflow: hidden;
        }
        
        .slide-art {
            width: 35%; height: 100%; display: flex; align-items: center;
            justify-content: center; font-size: 200px; text-shadow: 0 0 20px rgba(255, 45, 149, 0.8);
        }
        
        .slide-text {
            width: 65%; height: 100%; display: flex; flex-direction: column;
            justify-content: center; gap: 20px;
        }
        
        .slide-text h2 { font-size: 36px; margin: 0; color: #ffdd57; text-shadow: 0 0 10px #ff9600; }
        .slide-text p { font-size: 18px; line-height: 1.6; margin: 0; color: #fff; }
        .slide-text .action { font-size: 24px; font-weight: bold; color: #ff2d95; animation: pulse 0.8s infinite; }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
        
        .slide-nav {
            position: absolute; bottom: 20px; right: 20px;
            display: flex; gap: 10px;
        }
        
        .slide-btn {
            background: #ff2d95; color: #fff; border: none;
            padding: 10px 20px; border-radius: 4px; cursor: pointer;
            font-weight: bold; font-size: 12px;
        }
        
        .slide-btn:hover { background: #ff1080; }
        .slide-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        
        .slide-counter { position: absolute; top: 20px; right: 20px; font-size: 14px; color: #aaa; }
        
        .muted { opacity: 0.7; }
        .small { font-size: 12px; }
    </style>
</head>
<body>
    <div class="wrap">
        <h1>üíî LOVE HURTS üíî ‚Äî Saturday 2/13/26 ‚Ä¢ Exit Bar 9PM‚Äì2AM</h1>
        <div class="ui">
            <div class="panel">‚ù§Ô∏è Lives: <span id="lives">3</span></div>
            <div class="panel">‚öîÔ∏è Wave: <span id="level">1</span></div>
            <div class="panel">‚ú® Combo: <span id="combo">0</span></div>
            <div class="panel">‚≠ê Score: <span id="score">0</span></div>
            <div class="panel">üî• Multiplier: <span id="mult">1x</span></div>
        </div>
        <canvas id="game" width="800" height="500"></canvas>
        <div class="controls">
            ‚¨ÖÔ∏è‚û°Ô∏è or A/D to Move ‚Ä¢ SPACE to Shoot ‚Ä¢ Build COMBOS ‚Ä¢ Dodge the Chaos üéØ<br/>
            <span class="muted">Impress the DJ and win the heart üíï</span>
        </div>
    </div>

    <div id="cutsceneContainer">
        <div class="slide-counter"><span id="slideNum">1</span> / <span id="slideTotal">1</span></div>
        <div class="cutscene-slide" id="cutsceneSlide">
            <div class="slide-art" id="slideArt">üéß</div>
            <div class="slide-text">
                <h2 id="slideTitle">Story</h2>
                <p id="slideDesc">Loading...</p>
                <div class="action" id="slideAction"></div>
            </div>
        </div>
        <div class="slide-nav">
            <button class="slide-btn" id="prevBtn" onclick="prevSlide()">‚Üê Back</button>
            <button class="slide-btn" id="nextBtn" onclick="nextSlide()">Next ‚Üí</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d');
        const W = canvas.width, H = canvas.height;

        // === GAME STATE ===
        let lives = 3, level = 1, score = 0, combo = 0, multiplier = 1;
        let gameActive = false, gamePaused = false;
        let particles = [], explosions = [];

        // === PLAYER ===
        const player = { x: W/2, y: H - 50, w: 40, h: 40, spd: 6, health: 100 };

        // === ENTITIES ===
        let bullets = [], enemies = [], powerups = [];
        let screenShake = 0, hitFlash = 0;

        // === CONTROLS ===
        const keys = {};
        window.addEventListener('keydown', e => { keys[e.key.toLowerCase()] = true; });
        window.addEventListener('keyup', e => { keys[e.key.toLowerCase()] = false; });

        // === UTILITIES ===
        const rand = (min, max) => Math.random() * (max - min) + min;
        const rectsCollide = (a, b) => a.x < b.x + b.w && a.x + a.w > b.x && a.y < b.y + b.h && a.y + a.h > b.y;
        const dist = (x1, y1, x2, y2) => Math.sqrt((x2-x1)**2 + (y2-y1)**2);

        // === PARTICLE SYSTEM ===
        function createParticle(x, y, color, vx, vy) {
            particles.push({ x, y, vx, vy, life: 30, color, size: 4 });
        }

        function createExplosion(x, y, color, count = 8) {
            for (let i = 0; i < count; i++) {
                const angle = (i / count) * Math.PI * 2;
                const v = 3 + Math.random() * 2;
                createParticle(x, y, color, Math.cos(angle) * v, Math.sin(angle) * v);
            }
            explosions.push({ x, y, radius: 0, maxRadius: 40, life: 20, color });
        }

        // === ENEMY SYSTEM ===
        function spawnBaddies() {
            const baseCount = 4 + level * 2;
            for (let i = 0; i < baseCount; i++) {
                const x = rand(40, W - 40);
                const y = rand(-400, -50);
                const type = level < 3 ? 'basic' : level < 5 ? 'split' : 'boss';
                enemies.push({
                    x, y, w: 28, h: 28, hp: type === 'basic' ? 1 : type === 'split' ? 2 : 5,
                    spd: 1.5 + level * 0.3, type, angle: 0, shootCool: 0
                });
            }
        }

        // === CUTSCENE SYSTEM ===
        const cutscenes = {
            1: [
                { art: 'üéß', title: 'The DJ', desc: 'Spinning beats at Exit Bar...', action: 'I need to catch their eye!' },
                { art: 'üíî', title: 'The Challenge', desc: 'But the dance floor is CHAOS...', action: 'Dodge & Impress!' },
            ],
            2: [
                { art: '‚ö°', title: 'They Notice!', desc: 'The DJ looked in your direction!', action: 'Stay focused...' },
                { art: 'üé∂', title: 'Tempo Rising', desc: 'The beat gets HARDER...', action: 'More enemies incoming!' },
            ],
            3: [
                { art: 'üòç', title: 'Eye Contact!', desc: 'You locked eyes across the dance floor!', action: 'Almost there!' },
                { art: 'üî•', title: 'Peak Hour', desc: 'The crowd is WILD...', action: 'Chaos everywhere!' },
            ],
            4: [
                { art: 'üí´', title: 'Moment of Truth', desc: 'The finals minutes before midnight...', action: 'Give it everything!' },
                { art: '‚≠ê', title: 'Last Stand', desc: 'One final wave of obstacles...', action: 'ALL IN!' },
            ],
            5: [
                { art: 'üëë', title: 'VICTORY!', desc: 'You won their heart on the dance floor!', action: 'Saturday 2/13 üéâ' },
                { art: 'üíï', title: 'Exit Bar Ready', desc: 'See you this Saturday at 9PM!', action: '9PM‚Äì2AM ‚Ä¢ Get Down!' },
            ]
        };

        let currentSlide = 0;
        let currentCutscene = 1;

        function showCutscene(n) {
            if (!cutscenes[n]) return;
            currentCutscene = n;
            currentSlide = 0;
            displaySlide();
            document.getElementById('cutsceneContainer').classList.add('active');
            gameActive = false;
        }

        function displaySlide() {
            const scene = cutscenes[currentCutscene] || [];
            const slide = scene[currentSlide];
            if (!slide) return;

            document.getElementById('slideArt').textContent = slide.art;
            document.getElementById('slideTitle').textContent = slide.title;
            document.getElementById('slideDesc').textContent = slide.desc;
            document.getElementById('slideAction').textContent = slide.action;
            document.getElementById('slideNum').textContent = currentSlide + 1;
            document.getElementById('slideTotal').textContent = scene.length;

            document.getElementById('prevBtn').disabled = currentSlide === 0;
            document.getElementById('nextBtn').disabled = currentSlide === scene.length - 1;

            // Auto-advance to next slide after 3 seconds
            setTimeout(() => {
                if (currentSlide < scene.length - 1) {
                    currentSlide++;
                    displaySlide();
                } else {
                    // Last slide - auto close and start game
                    closeCutscene();
                }
            }, 3000);
        }

        window.nextSlide = function() {
            const scene = cutscenes[currentCutscene] || [];
            if (currentSlide < scene.length - 1) {
                currentSlide++;
                displaySlide();
            } else {
                closeCutscene();
            }
        };

        window.prevSlide = function() {
            if (currentSlide > 0) {
                currentSlide--;
                displaySlide();
            }
        };

        function closeCutscene() {
            document.getElementById('cutsceneContainer').classList.remove('active');
            gameActive = true;
        }

        // === GAMEPLAY ===
        function startLevel(n) {
            level = n;
            lives = Math.max(lives, 2);
            combo = 0;
            multiplier = 1;
            score += level * 500;
            updateUI();
            
            bullets = [];
            enemies = [];
            powerups = [];
            screenShake = 0;
            player.x = W / 2;
            player.health = 100;

            spawnBaddies();
            showCutscene(n);
        }

        function updateUI() {
            document.getElementById('lives').textContent = lives;
            document.getElementById('level').textContent = level;
            document.getElementById('combo').textContent = combo;
            document.getElementById('score').textContent = score;
            document.getElementById('mult').textContent = multiplier + 'x';
        }

        function shoot() {
            const patterns = [
                [{ dx: 0, dy: -1 }],
                [{ dx: -0.3, dy: -1 }, { dx: 0, dy: -1 }, { dx: 0.3, dy: -1 }],
                [{ dx: -0.5, dy: -1 }, { dx: -0.25, dy: -1 }, { dx: 0, dy: -1 }, { dx: 0.25, dy: -1 }, { dx: 0.5, dy: -1 }],
            ];
            
            const pattern = patterns[Math.min(Math.floor(combo / 5), 2)];
            pattern.forEach(p => {
                bullets.push({
                    x: player.x + p.dx * 10,
                    y: player.y - 20,
                    w: 6, h: 12,
                    vx: p.dx * 2,
                    vy: p.dy * 8,
                    life: 300
                });
            });
        }

        // === MAIN LOOP ===
        let lastTime = performance.now();
        function gameLoop(t) {
            const dt = Math.min((t - lastTime) / 16, 2);
            lastTime = t;

            if (gameActive) {
                // INPUT
                if (keys['arrowleft'] || keys['a']) player.x = Math.max(20, player.x - player.spd);
                if (keys['arrowright'] || keys['d']) player.x = Math.min(W - 20, player.x + player.spd);
                if (keys[' ']) { shoot(); delete keys[' ']; }

                // UPDATE BULLETS
                for (let i = bullets.length - 1; i >= 0; i--) {
                    const b = bullets[i];
                    b.x += b.vx * dt;
                    b.y += b.vy * dt;
                    b.life--;
                    if (b.life <= 0 || b.y < -20) bullets.splice(i, 1);
                }

                // UPDATE ENEMIES
                enemies.forEach(e => {
                    e.y += e.spd * dt;
                    e.angle += 0.05 * dt;
                    e.shootCool--;
                });
                enemies = enemies.filter(e => e.y < H + 50);

                // COLLISION: BULLETS vs ENEMIES
                for (let i = bullets.length - 1; i >= 0; i--) {
                    for (let j = enemies.length - 1; j >= 0; j--) {
                        if (rectsCollide(bullets[i], enemies[j])) {
                            enemies[j].hp--;
                            score += 10 * multiplier;
                            combo++;
                            multiplier = 1 + Math.floor(combo / 10);
                            createExplosion(enemies[j].x, enemies[j].y, '#ff69b4', 6);
                            createParticle(bullets[i].x, bullets[i].y, '#ffbb00', 0, 0);

                            if (enemies[j].hp <= 0) {
                                if (enemies[j].type === 'split') {
                                    enemies.push({ ...enemies[j], x: enemies[j].x - 15, hp: 1 });
                                    enemies.push({ ...enemies[j], x: enemies[j].x + 15, hp: 1 });
                                }
                                score += 50 * multiplier;
                                enemies.splice(j, 1);
                            }

                            bullets.splice(i, 1);
                            screenShake = 4;
                            break;
                        }
                    }
                }

                // COLLISION: PLAYER vs ENEMIES
                const pBox = { x: player.x - 20, y: player.y - 20, w: 40, h: 40 };
                for (let i = enemies.length - 1; i >= 0; i--) {
                    if (rectsCollide(pBox, enemies[i])) {
                        lives--;
                        enemies.splice(i, 1);
                        combo = 0;
                        multiplier = 1;
                        hitFlash = 10;
                        screenShake = 8;
                        createExplosion(player.x, player.y, '#ff1080', 12);
                        if (lives <= 0) {
                            gameActive = false;
                            showGameOver();
                        }
                    }
                }

                // PARTICLES
                for (let i = particles.length - 1; i >= 0; i--) {
                    const p = particles[i];
                    p.x += p.vx;
                    p.y += p.vy;
                    p.life--;
                    if (p.life <= 0) particles.splice(i, 1);
                }

                // LEVEL CLEAR
                if (enemies.length === 0 && level < 5) {
                    startLevel(level + 1);
                } else if (enemies.length === 0 && level === 5) {
                    gameActive = false;
                    showCutscene(5);
                }
            }

            updateUI();
            draw(dt);
            requestAnimationFrame(gameLoop);
        }

        function draw(dt) {
            ctx.fillStyle = '#0a0a0a';
            ctx.fillRect(0, 0, W, H);

            // BACKGROUND EFFECT
            ctx.strokeStyle = 'rgba(255, 45, 149, 0.1)';
            ctx.lineWidth = 0.5;
            for (let i = 0; i < 10; i++) {
                ctx.beginPath();
                ctx.arc(W / 2, H / 2, 20 + i * 15, 0, Math.PI * 2);
                ctx.stroke();
            }

            ctx.save();
            if (screenShake > 0) {
                ctx.translate(rand(-screenShake, screenShake), rand(-screenShake, screenShake));
                screenShake *= 0.85;
            }

            // DRAW BULLETS
            ctx.fillStyle = '#ffdd57';
            bullets.forEach(b => {
                ctx.fillRect(b.x - b.w / 2, b.y, b.w, b.h);
                ctx.fillStyle = '#ffaa00';
                ctx.beginPath();
                ctx.arc(b.x, b.y, 3, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#ffdd57';
            });

            // DRAW ENEMIES
            enemies.forEach(e => {
                ctx.save();
                ctx.translate(e.x + e.w / 2, e.y + e.h / 2);
                ctx.rotate(e.angle);
                
                if (e.type === 'boss') {
                    ctx.fillStyle = '#ff1080';
                    ctx.beginPath();
                    for (let i = 0; i < 6; i++) {
                        const angle = (i / 6) * Math.PI * 2;
                        const x = Math.cos(angle) * 16;
                        const y = Math.sin(angle) * 16;
                        if (i === 0) ctx.moveTo(x, y);
                        else ctx.lineTo(x, y);
                    }
                    ctx.closePath();
                    ctx.fill();
                    ctx.font = 'bold 16px Arial';
                    ctx.fillText('üëë', -8, 6);
                } else if (e.type === 'split') {
                    ctx.fillStyle = '#ff69b4';
                    ctx.beginPath();
                    ctx.arc(0, 0, 12, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.fillStyle = '#fff';
                    ctx.font = '12px Arial';
                    ctx.fillText('üíî', -6, 4);
                } else {
                    ctx.fillStyle = '#ff3b6b';
                    ctx.beginPath();
                    ctx.arc(0, 0, 10, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.fillStyle = '#fff';
                    ctx.font = '10px Arial';
                    ctx.fillText('‚ù§', -3, 2);
                }
                ctx.restore();
            });

            // DRAW PLAYER
            ctx.save();
            if (hitFlash > 0) {
                ctx.globalAlpha = 0.5 + Math.sin(hitFlash) * 0.5;
                hitFlash--;
            }
            ctx.fillStyle = '#69f';
            ctx.beginPath();
            ctx.arc(player.x, player.y, 20, 0, Math.PI * 2);
            ctx.fill();
            ctx.font = 'bold 24px Arial';
            ctx.fillText('üíò', player.x - 12, player.y + 9);
            ctx.restore();

            // DRAW PARTICLES
            ctx.globalAlpha = 0.8;
            particles.forEach(p => {
                ctx.fillStyle = p.color;
                ctx.globalAlpha = p.life / 30;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                ctx.fill();
            });

            // DRAW EXPLOSIONS
            explosions.forEach(e => {
                ctx.strokeStyle = e.color;
                ctx.globalAlpha = e.life / 20;
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(e.x, e.y, e.radius, 0, Math.PI * 2);
                ctx.stroke();
                e.radius += e.maxRadius / e.life;
            });
            explosions = explosions.filter(e => e.life-- > 0);

            ctx.globalAlpha = 1;
            ctx.restore();

            // HUD CORNER TEXT
            ctx.fillStyle = '#aaa';
            ctx.font = '10px monospace';
            ctx.fillText('Saturday 2/13/26 ‚Ä¢ Exit Bar ‚Ä¢ 9PM', 8, H - 8);
        }

        function showGameOver() {
            currentCutscene = 0;
            currentSlide = 0;
            document.getElementById('slideArt').textContent = 'üò≠';
            document.getElementById('slideTitle').textContent = 'Game Over!';
            document.getElementById('slideDesc').textContent = `You scored ${score} points! The DJ will remember you... come back stronger!`;
            document.getElementById('slideAction').textContent = '‚ùå Try Again';
            document.getElementById('prevBtn').disabled = true;
            document.getElementById('nextBtn').textContent = 'Play Again';
            document.getElementById('nextBtn').disabled = false;
            document.getElementById('slideNum').style.display = 'none';
            document.getElementById('slideTotal').style.display = 'none';
            document.getElementById('cutsceneContainer').classList.add('active');
        }

        // START GAME
        startLevel(1);
        requestAnimationFrame(gameLoop);
    </script>
</body>
</html>
