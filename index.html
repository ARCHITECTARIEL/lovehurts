<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Friday Night DTSP - Love Hurts Shooter</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; touch-action: none; user-select: none; }
        body { background: #000; overflow: hidden; font-family: Arial, sans-serif; }

        #avatarEmbed { position: fixed; width: 110px; height: 110px; border-radius: 50%; overflow: hidden; z-index: 3; pointer-events: auto; transform: translate(-50%, -50%); display: block; }
        #avatarEmbed iframe { width: 100%; height: 100%; border: none; }
        #gameCanvas { position: fixed; z-index: 1; display: block; width: 100vw; height: 100vh; top: 0; left: 0; }
        #ui { position: absolute; top: 20px; left: 20px; color: white; text-shadow: 2px 2px 4px black; pointer-events: none; z-index: 10; }
        #score { font-size: 32px; color: #ff69b4; font-weight: bold; }
        #highScore { font-size: 18px; color: #dda0dd; margin-top: 5px; }
        #startScreen, #gameOverScreen { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(0,0,0,0.7); z-index: 20; }
        .hidden { display: none !important; }
        h1 { color: #ff69b4; font-size: 48px; text-shadow: 3px 3px 0 #8b008b; margin-bottom: 20px; text-align: center; }
        h2 { color: #dda0dd; font-size: 24px; margin-bottom: 30px; text-align: center; }
        button { background: linear-gradient(135deg, #ff1493, #9932cc); border: 3px solid white; color: white; font-size: 24px; font-weight: bold; padding: 20px 40px; border-radius: 50px; cursor: pointer; box-shadow: 0 0 30px rgba(255,20,147,0.6); }
        button:hover { transform: scale(1.1); }
        #instructions { position: absolute; bottom: 20px; left: 0; right: 0; text-align: center; color: white; font-size: 16px; text-shadow: 2px 2px 4px black; pointer-events: none; }
        /* Flirty UI */
        .flirty-btn { position: fixed; right: 20px; bottom: 20px; z-index: 30; background: linear-gradient(135deg,#ff6ab3,#9b59ff); border: 0; color: white; padding: 14px 18px; border-radius: 999px; font-size: 18px; box-shadow: 0 8px 30px rgba(155,89,182,0.2); cursor: pointer; }
        .flirty-btn:active { transform: scale(0.98); }
        .popup { position: fixed; z-index: 25; right: 24px; top: 120px; background: linear-gradient(135deg,#ffecf9,#ffe6f0); color:#8b0066; padding:12px 16px; border-radius:12px; box-shadow:0 8px 30px rgba(0,0,0,0.25); font-weight:700; transform-origin:top right; animation: popIn 400ms ease; }
        @keyframes popIn { from { transform: translateY(-8px) scale(0.95); opacity:0 } to { transform: translateY(0) scale(1); opacity:1 } }
        .qr-modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 40; display:flex; align-items:center; justify-content:center; }
        .qr-modal { background: linear-gradient(180deg,#fff0fb,#ffeef8); padding:20px; border-radius:16px; box-shadow:0 12px 50px rgba(0,0,0,0.4); max-width:420px; text-align:center; color:#6a004b; }
        .qr-modal h3 { margin:8px 0 6px; font-size:20px }
        .qr-modal p { margin:0 0 12px; font-size:14px }
        .qr-actions { display:flex; gap:8px; justify-content:center; margin-top:12px }
        .qr-actions button { padding:8px 12px; border-radius:10px; border:0; font-weight:700; cursor:pointer }
        .qr-actions .primary { background:#ff1493; color:white }
        .qr-actions .ghost { background:transparent; border:2px solid #ffd6ee; color:#8b006b }
    </style>
</head>
<body>
        <!-- Background embed (Canva) -->
        <div id="flyerEmbed" style="position:fixed;inset:0;z-index:0;overflow:hidden;width:100%;height:100%;pointer-events:none;">
            <iframe loading="lazy" src="https://www.canva.com/design/DAHBItMJnyg/Z2H4H3HavEOSNOkKhibt4w/view?embed" allowfullscreen="allowfullscreen" allow="fullscreen" style="position:absolute;width:100%;height:100%;top:0;left:0;border:none;"></iframe>
        </div>
        <!-- Avatar embed (Canva) positioned above the canvas and follows the target (interactive) -->
        <div id="avatarEmbed">
            <iframe loading="lazy" src="https://www.canva.com/design/DAHBIgOXuHY/7fapbG7I1WSa4DT58YPbhw/view?embed" allowfullscreen="allowfullscreen" allow="fullscreen"></iframe>
        </div>

        <canvas id="gameCanvas"></canvas>
    <div id="ui">
        <div id="score">SCORE: 0</div>
        <div id="highScore">HIGH: 0</div>
    </div>
    <div id="startScreen">
        <h1>LOVE HURTS</h1>
        <h2>Friday Night DTSP ‚Ä¢ 2/13/26<br>Shoot the DJ!</h2>
        <button id="startBtn">PLAY NOW üíò</button>
    </div>
    <div id="gameOverScreen" class="hidden">
        <h1>GAME OVER</h1>
        <h2 id="finalScore">Score: 0</h2>
        <button id="restartBtn">TRY AGAIN üéØ</button>
    </div>
    <div id="instructions">Desktop: Mouse to aim, Click to shoot | Mobile: Touch to aim & shoot</div>

        <button id="infoBtn" class="flirty-btn">üíò Show Info</button>

        <!-- QR modal (hidden) -->
        <div id="qrModal" class="qr-modal-overlay" style="display:none">
            <div class="qr-modal">
                <h3>üåô After Party at The Warehouse</h3>
                <p><strong>3AM until Sunrise ‚Ä¢ $15 at door</strong><br>Show this QR = $5 off! Buy 2 Get 1 Free üçπ</p>
                <img id="qrImg" src="" alt="QR Code" style="width:260px;height:260px;border-radius:8px;background:white;">
                <div class="qr-actions">
                    <button id="copyLinkBtn" class="ghost">üéâ See Party</button>
                    <button id="downloadQrBtn" class="primary">Download QR</button>
                </div>
                <div style="margin-top:10px"><button id="closeQr" class="ghost">Close</button></div>
            </div>
        </div>

    <script>
        // YOUR ACTUAL IMAGES FROM IMGUR
        const FLYER_URL = 'https://i.imgur.com/pwIpd8E.png';
        const AVATAR_URL = 'https://i.imgur.com/y8tV91O.png';
        
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        let gameRunning = false;
        let score = 0;
        let highScore = localStorage.getItem('lovehurts_highscore') || 0;
        let mouseX = window.innerWidth / 2;
        
        document.getElementById('highScore').textContent = 'HIGH: ' + highScore;
        
        // (Using Imgur flyer as CSS background) no canvas background image needed
        const avatarEmbed = document.getElementById('avatarEmbed');
        const avatarPresent = !!avatarEmbed;

        // After-party URL and QR (absolute URL so it works when scanned from phone)
        const afterPartyUrl = window.location.origin + '/afterparty.html';
        function buildQrUrl(url, size=300) {
            return 'https://chart.googleapis.com/chart?cht=qr&chs=' + size + 'x' + size + '&chl=' + encodeURIComponent(url) + '&chld=L|1';
        }

        // Popups - Event-focused & flirty
        const popupMessages = [
            'üéâ Friday Night DTSP starts at 10PM!',
            'üçπ Early bird specials until 11 ‚Äî $3 cocktails üíï',
            'üíñ Need a VIP table? We got you! üíñ',
            'üéÅ Free Love Hurts sticker at the door',
            'üéß DJs spinning all night!',
            'üíò Dress to impress, we\'re checking you out',
            '‚ú® Best dressed wins a free drink!',
            'üî• This is going to be FIRE üî•'
        ];
        function showPopup(message, ttl=3500) {
            const el = document.createElement('div');
            el.className = 'popup';
            el.innerText = message;
            document.body.appendChild(el);
            setTimeout(() => el.style.opacity = '0', ttl - 400);
            setTimeout(() => el.remove(), ttl);
        }

        // schedule popups every ~18-25s
        let popupIdx = 0;
        function schedulePopups() {
            showPopup(popupMessages[popupIdx % popupMessages.length]);
            popupIdx++;
            setTimeout(schedulePopups, 18000 + Math.random()*7000);
        }

        // QR modal handling
        const infoBtn = document.getElementById('infoBtn');
        const qrModal = document.getElementById('qrModal');
        const qrImg = document.getElementById('qrImg');
        const copyLinkBtn = document.getElementById('copyLinkBtn');
        const downloadQrBtn = document.getElementById('downloadQrBtn');
        const closeQr = document.getElementById('closeQr');

        function openQrModal() {
            qrImg.src = buildQrUrl(afterPartyUrl, 520);
            qrModal.style.display = 'flex';
        }
        function closeQrModal() { qrModal.style.display = 'none'; }
        infoBtn.addEventListener('click', () => { openQrModal(); });
        closeQr.addEventListener('click', closeQrModal);
        copyLinkBtn.addEventListener('click', () => {
            window.location.href = afterPartyUrl;
        });
        downloadQrBtn.addEventListener('click', () => {
            const src = buildQrUrl(afterPartyUrl, 1000);
            const a = document.createElement('a');
            a.href = src; a.download = 'afterparty-qr.png'; document.body.appendChild(a); a.click(); a.remove();
        });

        // start scheduled popups after a short delay
        setTimeout(() => { schedulePopups(); }, 3000);

        // Auto-trigger QR popup after first hit or randomly during gameplay
        let shotsFired = 0;
        function triggerQrPopupRandomly() {
            if (gameRunning && shotsFired > 2 && Math.random() < 0.15) {
                openQrModal();
            }
        }
        
        let cupid = { x: 0, y: 0, recoil: 0 };
        let arrows = [];
        let target = { x: 0, y: 0, vx: 3, hit: false, hitTimer: 0 };
        let particles = [];
        let floatingTexts = [];
        let bgHearts = [];
        
        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            cupid.y = canvas.height - 80;
            cupid.x = canvas.width / 2;
            target.y = canvas.height * 0.25;
        }
        window.addEventListener('resize', resize);
        resize();
        
        // Controls
        canvas.addEventListener('mousemove', (e) => {
            mouseX = e.clientX;
            cupid.x = mouseX;
        });
        
        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            mouseX = e.touches[0].clientX;
            cupid.x = mouseX;
        });
        
        canvas.addEventListener('mousedown', shoot);
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            mouseX = e.touches[0].clientX;
            cupid.x = mouseX;
            shoot();
        });
        
        function shoot() {
            if (!gameRunning || arrows.length > 5) return;
            arrows.push({ x: cupid.x, y: cupid.y - 20, speed: 15 });
            cupid.recoil = 10;
            shotsFired++;
            triggerQrPopupRandomly();
        }
        
        function createExplosion(x, y) {
            for (let i = 0; i < 20; i++) {
                particles.push({
                    x: x, y: y,
                    vx: (Math.random() - 0.5) * 10,
                    vy: (Math.random() - 0.5) * 10,
                    life: 30,
                    color: i % 2 === 0 ? '#ff1493' : '#ffd700'
                });
            }
        }
        
        function update() {
            if (!gameRunning) return;
            
            cupid.x += (mouseX - cupid.x) * 0.2;
            cupid.x = Math.max(30, Math.min(canvas.width - 30, cupid.x));
            if (cupid.recoil > 0) cupid.recoil *= 0.9;
            
            arrows = arrows.filter(arrow => {
                arrow.y -= arrow.speed;
                return arrow.y > -20;
            });
            
            if (!target.hit) {
                target.x += target.vx;
                if (target.x < 50 || target.x > canvas.width - 50) target.vx *= -1;
                target.y = canvas.height * 0.25 + Math.sin(Date.now() * 0.002) * 30;
            } else {
                target.hitTimer--;
                if (target.hitTimer <= 0) target.hit = false;
            }
            
            arrows.forEach((arrow, i) => {
                if (target.hit) return;
                const dx = arrow.x - target.x;
                const dy = arrow.y - target.y;
                const dist = Math.sqrt(dx*dx + dy*dy);
                
                if (dist < 50) {
                    target.hit = true;
                    target.hitTimer = 20;
                    target.vx *= 1.1;
                    score += 100;
                    document.getElementById('score').textContent = 'SCORE: ' + score;
                    createExplosion(target.x, target.y);
                    floatingTexts.push({ x: target.x, y: target.y - 60, text: '+100 üíò', life: 40, vy: -3 });
                    arrows.splice(i, 1);
                    
                    if (score > highScore) {
                        highScore = score;
                        localStorage.setItem('lovehurts_highscore', highScore);
                        document.getElementById('highScore').textContent = 'HIGH: ' + highScore;
                    }
                }
            });
            
            particles = particles.filter(p => {
                p.x += p.vx; p.y += p.vy; p.vy += 0.2; p.life--;
                return p.life > 0;
            });
            
            floatingTexts = floatingTexts.filter(t => {
                t.y += t.vy; t.life--;
                return t.life > 0;
            });
            
            if (Math.random() < 0.02) {
                bgHearts.push({
                    x: Math.random() * canvas.width,
                    y: canvas.height + 20,
                    size: Math.random() * 20 + 10,
                    speed: Math.random() * 2 + 1
                });
            }
            bgHearts = bgHearts.filter(h => {
                h.y -= h.speed;
                return h.y > -20;
            });
        }
        
        function draw() {
            // clear canvas so page background shows through
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Darken overlay (light so background remains visible)
            ctx.fillStyle = 'rgba(0,0,0,0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Background hearts
            ctx.fillStyle = '#ff69b4';
            ctx.globalAlpha = 0.3;
            bgHearts.forEach(h => {
                ctx.font = `${h.size}px Arial`;
                ctx.fillText('üíï', h.x, h.y);
            });
            ctx.globalAlpha = 1;
            
            // Particles
            particles.forEach(p => {
                ctx.fillStyle = p.color;
                ctx.globalAlpha = p.life / 30;
                ctx.beginPath();
                ctx.arc(p.x, p.y, 5, 0, Math.PI * 2);
                ctx.fill();
            });
            ctx.globalAlpha = 1;
            
            // Arrows
            arrows.forEach(arrow => {
                ctx.fillStyle = '#ffd700';
                ctx.fillRect(arrow.x - 2, arrow.y, 4, 20);
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('üíò', arrow.x, arrow.y - 5);
            });
            
            // If avatar embed exists, position it over the target; otherwise draw DJ target in-canvas
            if (avatarPresent && avatarEmbed) {
                // position the avatar element to follow the target
                avatarEmbed.style.left = target.x + 'px';
                avatarEmbed.style.top = target.y + 'px';
                // add a subtle hit shake when hit
                if (target.hit) avatarEmbed.style.transform = 'translate(-50%, -50%) translate(' + ((Math.random()-0.5)*8) + 'px,' + ((Math.random()-0.5)*8) + 'px)';
                else avatarEmbed.style.transform = 'translate(-50%, -50%)';
            } else {
                // Draw DJ target (fallback)
                ctx.save();
                ctx.translate(target.x, target.y);

                if (target.hit) {
                    ctx.translate((Math.random()-0.5)*10, (Math.random()-0.5)*10);
                    ctx.globalAlpha = 0.7;
                }

                // target circle
                ctx.beginPath();
                ctx.arc(0, 0, 45, 0, Math.PI * 2);
                ctx.fillStyle = 'rgba(255,255,255,0.06)';
                ctx.fill();

                // DJ emoji in the center
                ctx.font = '40px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillStyle = '#ff1493';
                ctx.fillText('üéß', 0, 0);

                ctx.strokeStyle = '#ff1493';
                ctx.lineWidth = 4;
                ctx.stroke();

                if (!target.hit) {
                    ctx.fillStyle = '#ff1493';
                    ctx.font = 'bold 16px Arial';
                    ctx.textAlign = 'center';
                    ctx.strokeStyle = 'white';
                    ctx.lineWidth = 3;
                    ctx.strokeText('Catch me if you can', 0, 65);
                    ctx.fillText('Catch me if you can', 0, 65);
                }

                ctx.globalAlpha = 1;
                ctx.restore();
            }
            
            // Cupid
            ctx.save();
            ctx.translate(cupid.x, cupid.y + cupid.recoil);
            ctx.font = '30px Arial';
            const wingOffset = Math.sin(Date.now() * 0.01) * 5;
            ctx.fillText('üïäÔ∏è', -35, -20 + wingOffset);
            ctx.fillText('üïäÔ∏è', 35, -20 - wingOffset);
            ctx.font = '50px Arial';
            ctx.fillText('üèπ', 0, 0);
            ctx.restore();
            
            // Floating texts
            floatingTexts.forEach(t => {
                ctx.globalAlpha = t.life / 40;
                ctx.fillStyle = '#ff69b4';
                ctx.font = 'bold 24px Arial';
                ctx.textAlign = 'center';
                ctx.strokeStyle = 'white';
                ctx.lineWidth = 3;
                ctx.strokeText(t.text, t.x, t.y);
                ctx.fillText(t.text, t.x, t.y);
            });
            ctx.globalAlpha = 1;
        }
        
        function loop() {
            update();
            draw();
            requestAnimationFrame(loop);
        }
        
        document.getElementById('startBtn').addEventListener('click', (e) => {
            e.stopPropagation();
            gameRunning = true;
            score = 0;
            document.getElementById('score').textContent = 'SCORE: 0';
            arrows = []; particles = []; floatingTexts = [];
            target.vx = 3; target.x = canvas.width / 2;
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('gameOverScreen').classList.add('hidden');
        });
        
        document.getElementById('restartBtn').addEventListener('click', (e) => {
            e.stopPropagation();
            gameRunning = true;
            score = 0;
            document.getElementById('score').textContent = 'SCORE: 0';
            arrows = []; particles = []; floatingTexts = [];
            target.vx = 3; target.x = canvas.width / 2;
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('gameOverScreen').classList.add('hidden');
        });
        
        loop();
    </script>
</body>
</html>
